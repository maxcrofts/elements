{"version":3,"file":"index.js","sources":["../src/AutoTabElement.ts","../src/index.ts"],"sourcesContent":["export default class AutoTabElement extends HTMLElement {\n\t/**\n\t * @internal\n\t */\n\tprivate _elements: HTMLElement[] | undefined;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.addEventListener(\"change\", this._handleChange.bind(this));\n\t\tthis.addEventListener(\"input\", this._handleInput.bind(this));\n\n\t\tconst observer = new MutationObserver(this._walk.bind(this));\n\t\tobserver.observe(this, {\n\t\t\tsubtree: true,\n\t\t\tchildList: true,\n\t\t\tattributes: true,\n\t\t});\n\t}\n\n\tconnectedCallback() {\n\t\tthis._walk();\n\t}\n\n\tdisconnnectedCallback() {\n\t\tthis._elements = undefined;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tprivate static _isCheckboxOrRadioInput(element: HTMLElement): boolean {\n\t\tconst inputElement = element as HTMLInputElement;\n\t\treturn (\n\t\t\telement.tagName === \"INPUT\" &&\n\t\t\t(inputElement.type === \"checkbox\" || inputElement.type === \"radio\")\n\t\t);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tprivate _handleChange(e: Event): void {\n\t\tconst target = e.target as HTMLElement;\n\n\t\tif (AutoTabElement._isCheckboxOrRadioInput(target)) {\n\t\t\tthis._update(target);\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tprivate _handleInput(e: Event): void {\n\t\tconst target = e.target as HTMLElement;\n\n\t\tif (!AutoTabElement._isCheckboxOrRadioInput(target)) {\n\t\t\tthis._update(target);\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tprivate _update(currentElement: HTMLElement): void {\n\t\tif (!(currentElement as any).validity.valid || !this._elements) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentIndex =\n\t\t\tthis._elements.findIndex((value) => value === currentElement) ?? -1;\n\t\tconst nextIndex = currentIndex + 1;\n\n\t\tif (currentIndex === -1 || nextIndex >= this._elements.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst nextElement = this._elements[nextIndex];\n\n\t\t// Skip disabled elements\n\t\tif (nextElement.matches(\":disabled\")) {\n\t\t\tthis._update(nextElement);\n\t\t\treturn;\n\t\t}\n\n\t\t// Special case for radio buttons\n\t\tif (nextElement.tagName === \"INPUT\") {\n\t\t\tconst nextInputElement = nextElement as HTMLInputElement;\n\t\t\tconst type = nextInputElement.type;\n\t\t\tconst name = nextInputElement.name;\n\n\t\t\tif (type === \"radio\" && name != null) {\n\t\t\t\tconst parentElement =\n\t\t\t\t\tnextInputElement.closest(\"form\") ?? document.body;\n\t\t\t\tconst selectedInputElement = parentElement.querySelector(\n\t\t\t\t\t`input[type=radio][name=${name}]:checked`,\n\t\t\t\t);\n\n\t\t\t\tif (selectedInputElement != null) {\n\t\t\t\t\tthis._update(nextInputElement);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tnextElement.focus();\n\n\t\t// Select all text\n\t\tif (\n\t\t\tnextElement.tagName === \"INPUT\" ||\n\t\t\tnextElement.tagName === \"TEXTAREA\"\n\t\t) {\n\t\t\t(nextElement as HTMLInputElement | HTMLTextAreaElement).select();\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tprivate _walk(): void {\n\t\tconst treeWalker = document.createTreeWalker(\n\t\t\tthis,\n\t\t\tNodeFilter.SHOW_ELEMENT,\n\t\t\t{\n\t\t\t\tacceptNode: (node) =>\n\t\t\t\t\t(node as HTMLElement).tabIndex >= 0\n\t\t\t\t\t\t? NodeFilter.FILTER_ACCEPT\n\t\t\t\t\t\t: NodeFilter.FILTER_SKIP,\n\t\t\t},\n\t\t);\n\n\t\tthis._elements = [];\n\t\tfor (\n\t\t\tlet node = treeWalker.nextNode();\n\t\t\tnode !== null;\n\t\t\tnode = treeWalker.nextNode()\n\t\t) {\n\t\t\tthis._elements.push(node as HTMLElement);\n\t\t}\n\n\t\t// Sort in ascending order, moving all 0s to the end\n\t\tthis._elements.sort((a, b) => {\n\t\t\tconst aTabIndex = a.tabIndex;\n\t\t\tconst bTabIndex = b.tabIndex;\n\n\t\t\tif (aTabIndex === 0) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (bTabIndex === 0) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\treturn a.tabIndex - b.tabIndex;\n\t\t});\n\t}\n}\n","import AutoTabElement from \"./AutoTabElement\";\n\nexport default AutoTabElement;\n\ndeclare global {\n\tinterface Window {\n\t\tAutoTabElement: typeof AutoTabElement;\n\t}\n\n\tinterface HTMLElementTagNameMap {\n\t\t\"auto-tab\": AutoTabElement;\n\t}\n}\n\nif (window.customElements.get(\"auto-tab\") === undefined) {\n\twindow.customElements.define(\"auto-tab\", AutoTabElement);\n\twindow.AutoTabElement = AutoTabElement;\n}\n"],"names":["E","c","__name","u","d","AutoTabElement","_handleChange","_handleInput","_walk","_elements","_isCheckboxOrRadioInput","element","inputElement","e","target","_update","currentElement","_a","_b","currentIndex","value","nextIndex","nextElement","nextInputElement","type","name","treeWalker","node","a","b","aTabIndex","bTabIndex"],"mappings":"+EAAA,IAAAA,EAAA,OAAA,eAAAC,EAAAC,EAAA,CAAAC,EAAAC,IAAAJ,EAAAG,EAAA,OAAA,CAAA,MAAAC,EAAA,aAAA,EAAA,CAAA,EAAA,KAAA,MAAqBC,UAAuB,WAAY,CAMvD,aAAc,CACb,MAAM,EAEN,KAAK,iBAAiB,SAAU,KAAKC,EAAc,KAAK,IAAI,CAAC,EAC7D,KAAK,iBAAiB,QAAS,KAAKC,EAAa,KAAK,IAAI,CAAC,EAE1C,IAAI,iBAAiB,KAAKC,EAAM,KAAK,IAAI,CAAC,EAClD,QAAQ,KAAM,CACtB,QAAS,GACT,UAAW,GACX,WAAY,EACb,CAAC,CACF,CAEA,mBAAoB,CACnB,KAAKA,EACN,CAAA,CAEA,uBAAwB,CACvB,KAAKC,EAAY,MAClB,CAKA,OAAeC,EAAwBC,EAA+B,CACrE,MAAMC,EAAeD,EACrB,OACCA,EAAQ,UAAY,UACnBC,EAAa,OAAS,YAAcA,EAAa,OAAS,QAE7D,CAKQN,EAAcO,EAAgB,CACrC,MAAMC,EAASD,EAAE,OAEbR,EAAeK,EAAwBI,CAAM,GAChD,KAAKC,EAAQD,CAAM,CAErB,CAKQP,EAAaM,EAAgB,CACpC,MAAMC,EAASD,EAAE,OAEZR,EAAeK,EAAwBI,CAAM,GACjD,KAAKC,EAAQD,CAAM,CAErB,CAKQC,EAAQC,EAAmC,CAhEpD,IAAAC,EAAAC,EAiEE,GAAI,CAAEF,EAAuB,SAAS,OAAS,CAAC,KAAKP,EACpD,OAGD,MAAMU,GACLF,EAAA,KAAKR,EAAU,UAAWW,GAAUA,IAAUJ,CAAc,IAA5D,KAAAC,EAAiE,GAC5DI,EAAYF,EAAe,EAEjC,GAAIA,IAAiB,IAAME,GAAa,KAAKZ,EAAU,OACtD,OAGD,MAAMa,EAAc,KAAKb,EAAUY,GAGnC,GAAIC,EAAY,QAAQ,WAAW,EAAG,CACrC,KAAKP,EAAQO,CAAW,EACxB,MACD,CAGA,GAAIA,EAAY,UAAY,QAAS,CACpC,MAAMC,EAAmBD,EACnBE,EAAOD,EAAiB,KACxBE,EAAOF,EAAiB,KAE9B,GAAIC,IAAS,SAAWC,GAAQ,QAE9BP,EAAAK,EAAiB,QAAQ,MAAM,IAA/B,KAAAL,EAAoC,SAAS,MACH,cAC1C,0BAA0BO,YAC3B,GAE4B,KAAM,CACjC,KAAKV,EAAQQ,CAAgB,EAC7B,MACD,CAEF,CAEAD,EAAY,MAAM,GAIjBA,EAAY,UAAY,SACxBA,EAAY,UAAY,aAEvBA,EAAuD,QAE1D,CAKQd,GAAc,CACrB,MAAMkB,EAAa,SAAS,iBAC3B,KACA,WAAW,aACX,CACC,WAAaC,GACXA,EAAqB,UAAY,EAC/B,WAAW,cACX,WAAW,WAChB,CACD,EAEA,KAAKlB,EAAY,GACjB,QACKkB,EAAOD,EAAW,SACtBC,EAAAA,IAAS,KACTA,EAAOD,EAAW,SAAS,EAE3B,KAAKjB,EAAU,KAAKkB,CAAmB,EAIxC,KAAKlB,EAAU,KAAK,CAACmB,EAAGC,IAAM,CAC7B,MAAMC,EAAYF,EAAE,SACdG,EAAYF,EAAE,SAEpB,OAAIC,IAAc,EACV,EAGJC,IAAc,EACV,GAGDH,EAAE,SAAWC,EAAE,QACvB,CAAC,CACF,CACD,CA5JqBxB,EAAAA,EAAAA,KAAAH,EAAAG,EAAA,gBAAA,ECcjB,OAAO,eAAe,IAAI,UAAU,IAAM,SAC7C,OAAO,eAAe,OAAO,WAAYA,CAAc,EACvD,OAAO,eAAiBA"}
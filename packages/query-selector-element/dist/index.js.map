{"version":3,"file":"index.js","sources":["../src/QuerySelectorElement.ts","../src/index.ts"],"sourcesContent":["export default class QuerySelector extends HTMLElement {\n\t/**\n\t * @internal\n\t */\n\tprivate _inputName: string | undefined;\n\n\t/**\n\t * @internal\n\t */\n\tprivate _selectors: string | undefined;\n\n\t/**\n\t * @internal\n\t */\n\tprivate _selectedElements: HTMLElement[] | undefined;\n\n\tstatic get observedAttributes(): string[] {\n\t\treturn [\"input-name\", \"selectors\"];\n\t}\n\n\tget inputName(): string | undefined {\n\t\treturn this._inputName;\n\t}\n\n\tset inputName(value: any) {\n\t\tif (value != null) {\n\t\t\tthis.setAttribute(\"input-name\", value.toString());\n\t\t} else {\n\t\t\tthis.removeAttribute(\"input-name\");\n\t\t}\n\t}\n\n\tget selectors(): string | undefined {\n\t\treturn this._selectors;\n\t}\n\n\tset selectors(value: any) {\n\t\tif (value != null) {\n\t\t\tthis.setAttribute(\"selectors\", value.toString());\n\t\t} else {\n\t\t\tthis.removeAttribute(\"selectors\");\n\t\t}\n\t}\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.addEventListener(\"change\", this._update.bind(this));\n\n\t\tconst observer = new MutationObserver(this._update.bind(this));\n\t\tobserver.observe(this, { subtree: true, childList: true });\n\t}\n\n\tattributeChangedCallback(\n\t\tname: string,\n\t\t_oldValue: string | undefined,\n\t\tnewValue: string | undefined\n\t): void {\n\t\tif (name === \"input-name\") {\n\t\t\tthis._inputName = newValue;\n\t\t} else if (name === \"selectors\") {\n\t\t\tthis._selectors = newValue;\n\t\t}\n\n\t\tthis._update();\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tprivate _update(): void {\n\t\t// Remove attribute from previously selected elements\n\t\tif (this._selectedElements !== undefined) {\n\t\t\tconst selectedElementsLength = this._selectedElements.length;\n\n\t\t\tfor (let i = 0; i < selectedElementsLength; i++) {\n\t\t\t\tdelete this._selectedElements[i].dataset.selected;\n\t\t\t}\n\n\t\t\tthis._selectedElements = undefined;\n\t\t}\n\n\t\t// Get selectors from input\n\t\tlet inputSelectors = \"\";\n\n\t\tif (this._inputName !== undefined) {\n\t\t\t// TODO: Support more than radio buttons\n\t\t\tconst input = this.querySelector(\n\t\t\t\t`input[name=${this._inputName}]:checked`\n\t\t\t);\n\n\t\t\tif (input !== null) {\n\t\t\t\tinputSelectors = input.getAttribute(\"value\") ?? \"\";\n\t\t\t}\n\t\t}\n\n\t\tif (this._selectors !== undefined) {\n\t\t\t// If we have a selectors attribute\n\t\t\tthis._selectedElements = Array.from(\n\t\t\t\tthis.querySelectorAll(this._selectors)\n\t\t\t);\n\t\t} else if (inputSelectors !== \"\") {\n\t\t\t// If an input has selected something\n\t\t\tthis._selectedElements = Array.from(\n\t\t\t\tthis.querySelectorAll(inputSelectors)\n\t\t\t);\n\t\t\t// Clear `inputSelectors` so we get the fast path below\n\t\t\tinputSelectors = \"\";\n\t\t}\n\n\t\tif (this._selectedElements !== undefined) {\n\t\t\tconst selectedElementsLength = this._selectedElements.length;\n\n\t\t\tif (inputSelectors !== \"\") {\n\t\t\t\tfor (let i = 0; i < selectedElementsLength; i++) {\n\t\t\t\t\tconst selectedElement = this._selectedElements[i];\n\n\t\t\t\t\tif (selectedElement.matches(inputSelectors)) {\n\t\t\t\t\t\tselectedElement.dataset.selected = \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (let i = 0; i < selectedElementsLength; i++) {\n\t\t\t\t\tthis._selectedElements[i].dataset.selected = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","import QuerySelectorElement from \"./QuerySelectorElement\";\n\nwindow.customElements.define(\"query-selector\", QuerySelectorElement);\n"],"names":["QuerySelector","_update","_inputName","value","_selectors","name","_oldValue","newValue","_a","_selectedElements","selectedElementsLength","i","inputSelectors","input","selectedElement","__name","QuerySelectorElement"],"mappings":"iKAAqBA,MAAAA,UAAsB,WAAY,CA4CtD,aAAc,CACb,MAAM,EAEN,KAAK,iBAAiB,SAAU,KAAKC,EAAQ,KAAK,IAAI,CAAC,EAEtC,IAAI,iBAAiB,KAAKA,EAAQ,KAAK,IAAI,CAAC,EACpD,QAAQ,KAAM,CAAE,QAAS,GAAM,UAAW,EAAK,CAAC,CAC1D,CAnCA,WAAW,oBAA+B,CACzC,MAAO,CAAC,aAAc,WAAW,CAClC,CAEA,IAAI,WAAgC,CACnC,OAAO,KAAKC,CACb,CAEA,IAAI,UAAUC,EAAY,CACrBA,GAAS,KACZ,KAAK,aAAa,aAAcA,EAAM,SAAU,CAAA,EAEhD,KAAK,gBAAgB,YAAY,CAEnC,CAEA,IAAI,WAAgC,CACnC,OAAO,KAAKC,CACb,CAEA,IAAI,UAAUD,EAAY,CACrBA,GAAS,KACZ,KAAK,aAAa,YAAaA,EAAM,SAAS,CAAC,EAE/C,KAAK,gBAAgB,WAAW,CAElC,CAWA,yBACCE,EACAC,EACAC,EACO,CACHF,IAAS,aACZ,KAAKH,EAAaK,EACRF,IAAS,cACnB,KAAKD,EAAaG,GAGnB,KAAKN,EACN,CAAA,CAKQA,GAAgB,CAtEzB,IAAAO,EAwEE,GAAI,KAAKC,IAAsB,OAAW,CACzC,MAAMC,EAAyB,KAAKD,EAAkB,OAEtD,QAASE,EAAI,EAAGA,EAAID,EAAwBC,IAC3C,OAAO,KAAKF,EAAkBE,GAAG,QAAQ,SAG1C,KAAKF,EAAoB,MAC1B,CAGA,IAAIG,EAAiB,GAErB,GAAI,KAAKV,IAAe,OAAW,CAElC,MAAMW,EAAQ,KAAK,cAClB,cAAc,KAAKX,YACpB,EAEIW,IAAU,OACbD,GAAiBJ,EAAAK,EAAM,aAAa,OAAO,IAA1B,KAAAL,EAA+B,GAElD,CAgBA,GAdI,KAAKJ,IAAe,OAEvB,KAAKK,EAAoB,MAAM,KAC9B,KAAK,iBAAiB,KAAKL,CAAU,CACtC,EACUQ,IAAmB,KAE7B,KAAKH,EAAoB,MAAM,KAC9B,KAAK,iBAAiBG,CAAc,CACrC,EAEAA,EAAiB,IAGd,KAAKH,IAAsB,OAAW,CACzC,MAAMC,EAAyB,KAAKD,EAAkB,OAEtD,GAAIG,IAAmB,GACtB,QAASD,EAAI,EAAGA,EAAID,EAAwBC,IAAK,CAChD,MAAMG,EAAkB,KAAKL,EAAkBE,GAE3CG,EAAgB,QAAQF,CAAc,IACzCE,EAAgB,QAAQ,SAAW,GAErC,KAESH,SAAAA,EAAI,EAAGA,EAAID,EAAwBC,IAC3C,KAAKF,EAAkBE,GAAG,QAAQ,SAAW,EAGhD,CACD,CACD,CAhIqBX,EAAAA,EAAAA,KAAAe,EAAAf,EAAA,eAAA,ECErB,OAAO,eAAe,OAAO,iBAAkBgB,CAAoB"}